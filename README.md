# 亿通行交通费发票整理工具使用说明

## 功能说明
本工具用于整理亿通行交通费发票，能够：
1. 从发票PDF中提取实际的发票号码
2. 解析行程单PDF中的行程信息
3. 比对发票金额与行程单金额
4. 生成包含发票号码的汇总报告

## 使用方法

### 1. 准备发票目录结构
在当前目录下创建一个发票目录，例如"12月发票"，然后在该目录下创建数字子目录，每个子目录代表一笔发票：

```
12月发票/
├── 1/
│   ├── invoice.pdf    # 发票PDF文件
│   └── trip.pdf       # 行程单PDF文件
├── 2/
│   ├── invoice.pdf
│   └── trip.pdf
├── 3/
│   ├── invoice.pdf
│   └── trip.pdf
...
```

### 2. 运行程序
```
    # 1. 创建虚拟环境
    python -m venv venv
    
     # 2. 激活虚拟环境
     # Windows:
     venv\Scripts\activate
    
     # 3. 升级pip到最新版本
     python -m pip install --upgrade pip -i https://pypi.tuna.tsinghua.edu.cn/simple/
   
    # 4. 使用清华大学镜像源安装依赖
   pip install -i https://pypi.tuna.tsinghua.edu.cn/simple/ PyMuPDF pypdf
```   

  然后您就可以运行您的程序了：

   1 python "亿通行交通费发票整理.py" "11月发票"

  当您完成工作后，可以退出虚拟环境：

   1 deactivate
运行 `亿通行交通费发票整理.py` 脚本，并在命令行提供目录名称参数：

```
python "亿通行交通费发票整理.py" "12月发票"
```

如果不提供参数，程序会默认使用"发票"目录名。

### 3. 输出文件
程序会生成两个文件：
- `{目录名称}汇总.md` - 包含发票号码、金额比对等详细信息的Markdown报告
- `{目录名称}号码汇总.txt` - 包含所有发票号码的文本文件

## 注意事项
1. 发票PDF文件必须命名为 `invoice.pdf`
2. 行程单PDF文件必须命名为 `trip.pdf`
3. 子目录必须以数字命名（如1, 2, 3...）
4. 程序会自动按数字顺序处理子目录

## 常见问题
- 如果发票号码提取不准确，可能是发票格式特殊，请联系开发者改进提取规则
- 如果金额比对不匹配，请检查PDF文件内容是否正确
- 如果遇到错误，请确保PDF文件没有损坏
